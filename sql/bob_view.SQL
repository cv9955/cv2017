CREATE OR REPLACE FORCE VIEW  "MENSUAL_BOB" ("AÑO", "MES", "COMPRAS", "CORRUGADO") AS 
  SELECT AÑO,MES,SUM(COMPRAS) AS COMPRAS,SUM(CORRUGADO) AS CORRUGADO FROM (
SELECT AÑO,MES,KILOS AS COMPRAS,0 AS CORRUGADO FROM MENSUAL_BOB_COMPRAS
UNION ALL
SELECT AÑO,MES,0 AS COMPRAS,KILOS AS CORRUGADO FROM MENSUAL_BOB_CORRUGADO)
GROUP BY AÑO,MES
/
CREATE OR REPLACE FORCE VIEW  "MENSUAL_BOB_COMPRAS" ("AÑO", "MES", "KILOS") AS 
  SELECT EXTRACT(YEAR FROM FECHA) AS AÑO,
EXTRACT(MONTH FROM FECHA) AS MES,
SUM(PESO) AS KILOS FROM BOB LEFT JOIN BOB_ORDEN ON BOB.ORDEN_INGRESO = BOB_ORDEN.ID
GROUP BY EXTRACT(YEAR FROM FECHA),EXTRACT(MONTH FROM FECHA)
/
CREATE OR REPLACE FORCE VIEW  "MENSUAL_BOB_CORRUGADO" ("AÑO", "MES", "KILOS") AS 
  SELECT EXTRACT(YEAR FROM FECHA) AS AÑO,
EXTRACT(MONTH FROM FECHA) AS MES, ROUND(SUM(BOB.PESO * BOB_USO.USO / 100)) AS KILOS
FROM BOB_USO LEFT JOIN BOB ON BOB_USO.BOBINA = BOB.ID
GROUP BY EXTRACT(YEAR FROM FECHA),EXTRACT(MONTH FROM FECHA)
/
CREATE OR REPLACE FORCE VIEW  "VIEW_BOB_STOCK_VALORIZADO" ("TIPO_PAPEL", "STOCK", "PRECIO") AS 
  select
    t.tipo_papel,
    v.stock,
    cotiz.get_precio_papel(t.id) precio
    
    from bob_tipo t,
    (
        select tipo,sum( peso * pstock) / 100  stock
        from bob
        where estado in (1,2)
        group by tipo) v 
    where t.id = v.tipo
/
