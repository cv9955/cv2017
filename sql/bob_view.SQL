<<<<<<< HEAD:BasedeDatos/bob_view.SQL
CREATE OR REPLACE FORCE VIEW "VIC"."VIEW_BOB_MENSUAL" ("PERIODO", "COMPRAS", "CORRUGADO") AS 
=======
CREATE OR REPLACE FORCE VIEW "VIEW_BOB_MENSUAL" ("PERIODO", "COMPRAS", "CORRUGADO") AS 
>>>>>>> bob001:sql/bob_view.SQL
  SELECT PERIODO, SUM(COMPRAS) COMPRAS,SUM(CORRUGADO) CORRUGADO FROM (
		SELECT TO_CHAR(O.FECHA,'YYYY/MM') PERIODO,
            SUM(BOB.PESO) COMPRAS,0 CORRUGADO
            FROM BOB_ORDEN O,BOB 
            WHERE O.ID = BOB.ORDEN_INGRESO
            GROUP BY TO_CHAR(O.FECHA,'YYYY/MM'),0
		UNION ALL
        SELECT TO_CHAR(U.FECHA,'YYYY/MM') PERIODO,0 COMPRAS,
            ROUND(SUM(BOB.PESO * U.USO / 100)) CORRUGADO
            FROM BOB_USO U,BOB
            WHERE U.BOBINA = BOB.ID
            GROUP BY TO_CHAR(U.FECHA,'YYYY/MM'),0
		)
<<<<<<< HEAD:BasedeDatos/bob_view.SQL
		GROUP BY PERIODO;
		
CREATE OR REPLACE FORCE VIEW CTRL_BAJA_BOBINA AS 
	SELECT FECHA, GREATEST (ABS (A-B) , ABS (A-C) ,ABS (B-C)) as dif FROM(
		SELECT FECHA,
			SUM(CASE WHEN LUGAR = 1 THEN BOB_PKG.METROSUSO(ID) ELSE 0 END) AS A,
			SUM(CASE WHEN LUGAR = 2 THEN BOB_PKG.METROSUSO(ID) ELSE 0 END) AS B,
			SUM(CASE WHEN LUGAR = 3 THEN BOB_PKG.METROSUSO(ID) ELSE 0 END) AS C
		FROM BOB_USO 
			GROUP BY FECHA)
	ORDER BY 2 DESC;
=======
		GROUP BY PERIODO
/

CREATE OR REPLACE FORCE VIEW  "MENSUAL_BOB_COMPRAS" ("Aﾃ前", "MES", "KILOS") AS 
  SELECT EXTRACT(YEAR FROM FECHA) AS Aﾃ前,
EXTRACT(MONTH FROM FECHA) AS MES,
SUM(PESO) AS KILOS FROM BOB LEFT JOIN BOB_ORDEN ON BOB.ORDEN_INGRESO = BOB_ORDEN.ID
GROUP BY EXTRACT(YEAR FROM FECHA),EXTRACT(MONTH FROM FECHA)
/
CREATE OR REPLACE FORCE VIEW  "MENSUAL_BOB_CORRUGADO" ("Aﾃ前", "MES", "KILOS") AS 
  SELECT EXTRACT(YEAR FROM FECHA) AS Aﾃ前,
EXTRACT(MONTH FROM FECHA) AS MES, ROUND(SUM(BOB.PESO * BOB_USO.USO / 100)) AS KILOS
FROM BOB_USO LEFT JOIN BOB ON BOB_USO.BOBINA = BOB.ID
GROUP BY EXTRACT(YEAR FROM FECHA),EXTRACT(MONTH FROM FECHA)
/
CREATE OR REPLACE FORCE VIEW  "VIEW_BOB_STOCK_VALORIZADO" ("TIPO_PAPEL", "STOCK", "PRECIO") AS 
  select
    t.tipo_papel,
    v.stock,
    cotiz.get_precio_papel(t.id) precio
    
    from bob_tipo t,
    (
        select tipo,sum( peso * pstock) / 100  stock
        from bob
        where estado in (1,2)
        group by tipo) v 
    where t.id = v.tipo
/
>>>>>>> bob001:sql/bob_view.SQL
